@startuml Xuất báo cáo Excel
title Biểu đồ tuần tự - Xuất báo cáo Excel

actor "Quản trị viên" as Admin
participant "Trình duyệt" as Browser
participant "ReportController" as Controller
participant "Database" as DB
participant "Excel Generator" as Excel

Admin -> Browser: Truy cập trang báo cáo
Browser -> Controller: GET /reports
Controller -> Browser: Hiển thị menu báo cáo

Admin -> Browser: Chọn loại báo cáo cần xuất
Admin -> Browser: Chọn khoảng thời gian
Admin -> Browser: Nhấn "Xuất Excel"
Browser -> Controller: POST /reports/export

Controller -> Controller: Validate export parameters

alt Validation thành công
    Controller -> DB: Get report data based on type
    DB -> Controller: Trả về dữ liệu báo cáo
    
    Controller -> Excel: generateExcelFile(reportData)
    Excel -> Excel: Create Excel workbook
    Excel -> Excel: Add data to sheets
    Excel -> Controller: Trả về Excel file path
    
    Controller -> Browser: Download Excel file
    Browser -> Admin: Tải file Excel về máy
    
else Validation thất bại
    Controller -> Browser: Redirect back with errors
    Browser -> Admin: Hiển thị thông báo lỗi
end

@enduml
