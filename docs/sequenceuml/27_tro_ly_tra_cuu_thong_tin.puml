@startuml Trợ lý tra cứu thông tin
title Biểu đồ tuần tự - Trợ lý tra cứu thông tin

actor "Quản trị viên" as Admin
participant "Trình duyệt" as Browser
participant "OmniAIController" as Controller
participant "LLMService" as LLMService
participant "Database" as DB

Admin -> Browser: Truy cập trang AI hỗ trợ
Browser -> Controller: GET /omni-ai
Controller -> Browser: Hiển thị giao diện AI chat

Admin -> Browser: Nhập câu hỏi bằng ngôn ngữ tự nhiên
Admin -> Browser: Nhấn "Gửi câu hỏi"
Browser -> Controller: POST /omni-ai/chat

Controller -> LLMService: analyzeQuery(userQuestion)
LLMService -> LLMService: Extract intent and entities
LLMService -> Controller: Trả về parsed query

alt AI hiểu được câu hỏi
    Controller -> DB: Execute query based on intent
    DB -> Controller: Trả về dữ liệu
    
    Controller -> LLMService: generateResponse(data)
    LLMService -> LLMService: Format data into natural language
    LLMService -> Controller: Trả về formatted response
    
    Controller -> Browser: Hiển thị câu trả lời
    Browser -> Admin: Hiển thị thông tin được yêu cầu
    
else AI không hiểu câu hỏi
    Controller -> Browser: Hiển thị yêu cầu làm rõ
    Browser -> Admin: Hiển thị "Tôi chưa hiểu rõ câu hỏi của bạn"
end

@enduml
