@startuml Phân tích xu hướng bán hàng
title Biểu đồ tuần tự - Phân tích xu hướng bán hàng

actor "Quản trị viên" as Admin
participant "Trình duyệt" as Browser
participant "OmniAIController" as Controller
participant "LLMService" as LLMService
participant "Order Model" as OrderModel
participant "Database" as DB

Admin -> Browser: Truy cập trang AI hỗ trợ
Browser -> Controller: GET /omni-ai
Controller -> Browser: Hiển thị giao diện AI

Admin -> Browser: Chọn "Phân tích xu hướng bán hàng"
Browser -> Controller: POST /omni-ai/sales-trend-analysis

Controller -> OrderModel: getSalesTrendData()
OrderModel -> DB: SELECT sales data for analysis
DB -> OrderModel: Trả về dữ liệu bán hàng
OrderModel -> Controller: Trả về salesTrendData

Controller -> LLMService: analyzeSalesTrends(salesTrendData)
LLMService -> LLMService: Analyze patterns and trends
LLMService -> LLMService: Generate insights

alt AI analysis thành công
    LLMService -> Controller: Trả về trend analysis
    Controller -> Browser: Hiển thị báo cáo xu hướng
    Browser -> Admin: Hiển thị biểu đồ và phân tích
    
else AI analysis thất bại
    Controller -> Browser: Hiển thị thông báo lỗi
    Browser -> Admin: Hiển thị thông báo không thể phân tích
end

@enduml
